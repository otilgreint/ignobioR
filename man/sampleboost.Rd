% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/optimised_sampling.R
\name{sampleboost}
\alias{sampleboost}
\title{Boosted Sampling Optimization}
\usage{
sampleboost(
  ndvi,
  ignorance,
  site,
  excl_areas = NULL,
  CRS.new = 3035,
  samp_strategy = "random",
  nplot,
  plot_radius,
  perm,
  ndvi.weight = 1,
  igno.weight = 1,
  dist.weight = 1,
  dem = NULL,
  dem.weight = 1,
  slope_max = NULL,
  extract_method = "auto",
  within_var_weight = 0.5,
  verbose = TRUE,
  output_dir = file.path(getwd(), "output"),
  output_prefix = "SampleBoost"
)
}
\arguments{
\item{ndvi}{A `terra SpatRaster` object representing NDVI or other environmental index.}

\item{ignorance}{A `terra SpatRaster` object representing the Map of Relative Floristic Ignorance (MRFI).}

\item{site}{An `sf` polygon object defining the study area boundary.}

\item{excl_areas}{Optional `sf` object (or 'SpatialPolygonsDataFrame') to 
delimit unsuitable areas (e.g., water bodies, inaccessible areas) to be 
excluded from sampling. If no CRS is set, assumes EPSG:4326.}

\item{CRS.new}{Numeric EPSG code for projected CRS used in calculations (must 
be in meters). Default = 3035 (ETRS89-LAEA Europe).}

\item{samp_strategy}{Character. Sampling strategy. Options: "random", "regular", "hexagonal". Default = "random".}

\item{nplot}{Integer. Number of sampling plots per permutation.}

\item{plot_radius}{Numeric. Radius of circular plots in meters (e.g., 20 for 20m radius plots, giving ~1,257m² area).}

\item{perm}{Integer. Number of permutations (sampling configurations) to test.}

\item{ndvi.weight}{Numeric. Weight for NDVI variance score (default = 1).}

\item{igno.weight}{Numeric. Weight for mean ignorance score (default = 1).}

\item{dist.weight}{Numeric. Weight for spatial dispersion score (default = 1).}

\item{dem}{A `terra SpatRaster` DEM (optional). If provided, elevation variance included in optimization.}

\item{dem.weight}{Numeric. Weight for DEM variance (default = 1, ignored if dem = NULL).}

\item{slope_max}{Numeric. Maximum slope in degrees for accessibility (e.g., 30). Requires dem.}

\item{extract_method}{Character. "auto" (default), "point", or "area" for raster value extraction.}

\item{within_var_weight}{Numeric. Weight for within-plot variance (0-1, default = 0.5).}

\item{verbose}{Logical. Print progress messages (default = TRUE).}

\item{output_dir}{Character. Directory for output files (default = working directory).}

\item{output_prefix}{Character. Prefix for output filenames (default = "SampleBoost").}
}
\value{
A list with full_matrix, aggregated_scores, best_solution, best_solution_sf,
best_variance, best_ignorance, best_dispersion, best_final_score, plots, and statistics.
}
\description{
Performs multi-objective sampling optimization by generating multiple 
permutations of random sampling points and evaluating each configuration
based on weighted scores for:
\itemize{
 \item NDVI variance (environmental heterogeneity, between and within plots)
 \item Mean ignorance value (prioritizing understudied areas)
 \item Spatial dispersion (using mean nearest neighbor distance)
 \item DEM variance (optional, elevation heterogeneity)
}
Returns the best non-overlapping configuration with field-ready outputs.
}
\details{
Uses mean nearest neighbor distance for spatial dispersion (100x faster than L-function).

**Extraction Method**: Automatically determined based on plot size relative to raster resolution:
\itemize{
  \item{Area-based extraction}{ Used when plot area > 4× raster cell area. Extracts all pixels 
  whose centroids fall within the circular plot buffer (centroid method). This avoids including 
  pixels that barely touch the plot edge, providing accurate representation of plot contents. 
  Calculates mean and variance from these pixels for within-plot heterogeneity assessment.}
  \item{Point extraction}{ Used for plots smaller than 4× raster cell area. Extracts single value 
  at plot center, with within-plot variance set to 0.}
}

For 90m resolution NDVI (8,100m² cells), area extraction is used for plots >32,400m² (radius >102m).
For 10m resolution data (100m² cells), area extraction is used for plots >400m² (radius >11m).

**Resolution Handling**: If DEM and NDVI have different resolutions, DEM is automatically 
resampled to match NDVI resolution using bilinear interpolation. This ensures fair comparison 
of variances and consistent pixel alignment across all rasters.

All rasters are cropped and masked to the site boundary.

**Boundary Constraint**: Plot centers are constrained to be at least plot_radius distance from 
the study area boundary, ensuring all plot buffers remain entirely within the study area. This 
is achieved through negative buffering of the sampling area.

**Adaptive Map Layout**: The function automatically detects study area shape and optimizes layout:
\itemize{
  \item{E-W oriented areas (aspect ratio > 1.3)}{ Maps stacked vertically (one above the other) 
  to use full width of landscape page}
  \item{N-S or square areas (aspect ratio ≤ 1.3)}{ Maps arranged side-by-side for efficient space use}
}

PDF Output Structure:

**Without DEM (3 pages, A4 landscape):**
\itemize{
  \item{Page 1}{ Best Sampling Configuration - NDVI and Ignorance maps (adaptive layout)}
  \item{Page 2}{ Optimization Diagnostics - Objective contribution bar chart showing why the 
  best solution won, plus multi-objective optimization space (NDVI vs Ignorance)}
  \item{Page 3}{ Summary Statistics - Complete parameter table}
}

**With DEM (4 pages, A4 landscape):**
\itemize{
  \item{Page 1}{ Best Sampling Configuration - NDVI and Ignorance maps (adaptive layout)}
  \item{Page 2}{ Best Sampling Configuration - DEM and Slope maps (adaptive layout)}
  \item{Page 3}{ Optimization Diagnostics - Objective contribution bar chart showing why the 
  best solution won, plus two multi-objective spaces (Environmental: NDVI vs Ignorance; 
  Topographic: DEM vs Ignorance)}
  \item{Page 4}{ Summary Statistics - Complete parameter table}
}
}
\examples{
\dontrun{
# Load example data
ndvi <- load_ndvi_example()
mrfi <- load_mrfi_example()
data(park)
data(unsuitablezone)

# Basic usage
result <- sampleboost(
  ndvi = ndvi,
  ignorance = mrfi,
  site = park,
  nplot = 50,
  plot_radius = 5.64,  # ~100m² plots
  perm = 100
)

# With exclusion areas (water bodies, inaccessible areas)
result <- sampleboost(
  ndvi = ndvi,
  ignorance = mrfi,
  site = park,
  excl_areas = unsuitablezone,
  nplot = 50,
  plot_radius = 5.64,
  perm = 100
)

# With DEM and slope constraints
dem <- load_dem_example()
result <- sampleboost(
  ndvi = ndvi,
  ignorance = mrfi,
  site = park,
  excl_areas = unsuitablezone,
  nplot = 50,
  plot_radius = 20,  # ~1,257m² plots
  perm = 100,
  dem = dem,
  slope_max = 30
)

# With custom CRS (e.g., UTM zone 32N for Italy)
result <- sampleboost(
  ndvi = ndvi,
  ignorance = mrfi,
  site = park,
  CRS.new = 32632,  # EPSG:32632 = WGS 84 / UTM zone 32N
  nplot = 50,
  plot_radius = 10,  # ~314m² plots
  perm = 100
)

# Access results
plot(result$plots$ndvi)
write.csv(result$best_solution, "best_sampling_points.csv")
}
}
