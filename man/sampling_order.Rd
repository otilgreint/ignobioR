% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sampling_order.R
\name{sampling_order}
\alias{sampling_order}
\title{Sampling Order Optimization}
\usage{
sampling_order(
  best_solution_sf,
  ogus = NULL,
  ogu_id_col = "OGU",
  ndvi_weight = 1,
  dem_weight = 0.5,
  start_plot = "auto",
  verbose = TRUE,
  output_dir = file.path(getwd(), "output"),
  output_prefix = "SamplingOrder"
)
}
\arguments{
\item{best_solution_sf}{An sf object from sampleboost() containing plot locations 
and environmental data (must have columns: ndvi_mean, and optionally elevation)}

\item{ogus}{Optional sf polygon object defining Operational Geographic Units (OGUs).
If provided, plots are assigned to OGUs via spatial intersection, and ordering
is done separately within each OGU. OGUs are typically pre-defined study area
zones (e.g., "North Valley", "South Ridge") based on ecological, logistical,
or administrative criteria.}

\item{ogu_id_col}{Character. Name of column in `ogus` containing OGU names/identifiers
(default = "OGU"). Ignored if `ogus` is NULL.}

\item{ndvi_weight}{Numeric. Weight for NDVI in environmental distance calculation (default = 1)}

\item{dem_weight}{Numeric. Weight for elevation in environmental distance calculation (default = 0.5)}

\item{start_plot}{Can be:
\itemize{
  \item "auto" (default): Automatically selects most environmentally extreme plot in each OGU
  \item "centroid": Selects plot closest to environmental centroid (most "average" plot) - useful if starting from accessible center
  \item Integer: Single plot ID to start from (if no OGUs)
  \item Named vector: Starting plot ID for each OGU, e.g. c("North" = 5, "South" = 12)
}}

\item{verbose}{Logical. Print progress messages (default = TRUE)}

\item{output_dir}{Character. Directory for output files (default = working directory)}

\item{output_prefix}{Character. Prefix for output filenames (default = "SamplingOrder")}
}
\value{
A list containing:
\itemize{
  \item{ordered_plots}{ sf object with sampling_order and OGU columns added}
  \item{field_ready}{ Data frame with complete field information}
  \item{env_distance_matrix}{ Environmental distance matrix between all plots}
  \item{summary}{ Data frame with ordering statistics}
}

Additionally, two files are automatically saved to output_dir:
\itemize{
  \item{[prefix]_field-ready.csv}{ Complete field sheet with Plot_ID, Sampling_Order, 
  OGU (if applicable), coordinates (lat/lon), NDVI, elevation - everything in one file}
  \item{[prefix]_summary.txt}{ Summary statistics and field instructions}
}
}
\description{
Generates an optimized sampling order for field plots based on environmental 
diversity (NDVI, DEM) to maximize species accumulation efficiency. Can optionally
work within pre-defined Operational Geographic Units (OGUs) for field logistics.
}
\details{
**Ordering Algorithm (Maximin Diversity)**:
Iteratively selects plots that maximize environmental diversity by choosing the 
plot that is most different from all previously selected plots. This ensures 
rapid saturation of the species accumulation curve.

**Environmental Distance**: Euclidean distance in standardized environmental space:
\deqn{d_{ij} = \sqrt{w_{ndvi} \times (NDVI_i - NDVI_j)^2 + w_{dem} \times (DEM_i - DEM_j)^2}}

**With OGUs**:
If OGUs are provided, maximin diversity ordering is applied separately within each
OGU. The user decides which OGU to sample first based on field logistics (accessibility,
weather, permits, etc.). Each OGU gets its own sampling sequence starting from 1.

**Without OGUs**:
Pure diversity-based ordering across all plots globally.
}
\section{OGU Format}{

The `ogus` parameter should be an sf object with POLYGON or MULTIPOLYGON geometry containing:
\itemize{
  \item **Geometry**: Polygon boundaries defining each OGU zone
  \item **ID column**: Character or factor column with OGU names (e.g., "North_Valley", "Lake_Shore")
  \item **CRS**: Must have a valid CRS (will be matched to plot CRS automatically)
}

**Example OGU creation:**
\preformatted{
# From shapefile
ogus <- st_read("study_zones.shp")

# Or create manually
library(sf)
north <- st_polygon(list(matrix(c(x_coords, y_coords), ncol=2)))
south <- st_polygon(list(matrix(c(x_coords2, y_coords2), ncol=2)))
ogus <- st_sf(
  OGU = c("North", "South"),
  geometry = st_sfc(north, south),
  crs = 3035
)
}
}

\examples{
\dontrun{
# Run sampleboost first
result <- sampleboost(ndvi, ignorance, site, nplot = 50, plot_radius = 20, perm = 100)

# Simple diversity ordering (no OGUs) - auto selects most extreme plot
order1 <- sampling_order(result$best_solution_sf)

# Start from most "average" plot (closest to centroid) - useful for accessible center
order2 <- sampling_order(result$best_solution_sf, start_plot = "centroid")

# With user-defined OGUs - auto selects most extreme in each OGU
my_zones <- st_read("study_zones.shp")
order3 <- sampling_order(
  result$best_solution_sf, 
  ogus = my_zones,
  ogu_id_col = "zone_name"
)

# Specify starting plot for each OGU (based on access points!)
# E.g., Plot 5 is near north parking, Plot 23 is near south trail
order4 <- sampling_order(
  result$best_solution_sf, 
  ogus = my_zones,
  ogu_id_col = "zone_name",
  start_plot = c("North_Valley" = 5, "South_Ridge" = 23, "Lake_Shore" = 12)
)

# Custom output location
final <- sampling_order(
  result$best_solution_sf, 
  ogus = my_zones,
  ogu_id_col = "zone_name",
  start_plot = c("North_Valley" = 5, "South_Ridge" = 23),
  output_dir = "~/fieldwork",
  output_prefix = "LakeVico_2025"
)
}
}
