% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compare_mrfi.R
\name{compare_mrfi}
\alias{compare_mrfi}
\title{Compare Two Maps of Relative Floristic Ignorance (Incremental Approach)}
\usage{
compare_mrfi(
  data_flor_initial,
  data_flor_updated,
  site,
  tau,
  cellsize,
  year_initial = NULL,
  year_updated = NULL,
  excl_areas = NULL,
  CRS.new = 3035,
  target_quantile = 0.75,
  output_dir = file.path(getwd(), "output"),
  output_prefix = "MRFI_comparison",
  verbose = TRUE,
  site_buffer = FALSE,
  buffer_width = NULL,
  mask_method = "touches",
  use_coverage_weighting = TRUE,
  ...
)
}
\arguments{
<<<<<<< HEAD
\item{data_flor_initial}{Data frame with initial floristic data. Must have columns: Taxon, Long, Lat, uncertainty, year.}

\item{data_flor_updated}{Data frame with updated/complete floristic data. Must have columns: Taxon, Long, Lat, uncertainty, year.}

\item{site}{An sf object representing the study area.}

\item{tau}{Numeric. Temporal decay parameter (percent taxa loss per 100 years).}
=======
\item{data_flor_initial}{Data frame with initial floristic data. Must have
columns: Taxon, Long, Lat, uncertainty, year.}

\item{data_flor_updated}{Data frame with updated/complete floristic data.
Must have columns: Taxon, Long, Lat, uncertainty, year.}

\item{site}{An `sf` object representing the study area.}

\item{tau}{Numeric. Temporal decay parameter (% taxa loss per 100 years).}
>>>>>>> 9d6153617b215062451e987f0669f906bff0a505

\item{cellsize}{Numeric. Raster cell size in meters.}

\item{year_initial}{Numeric. Year of initial survey (default: extracted from data).}

\item{year_updated}{Numeric. Year of updated survey (default: extracted from data).}

<<<<<<< HEAD
\item{excl_areas}{Optional sf object for exclusion areas.}
=======
\item{excl_areas}{Optional `sf` object for exclusion areas.}
>>>>>>> 9d6153617b215062451e987f0669f906bff0a505

\item{CRS.new}{Numeric EPSG code for projected CRS (default = 3035).}

\item{target_quantile}{Numeric. Quantile for IRFI categorization (default = 0.75).}

<<<<<<< HEAD
\item{output_dir}{Character. Directory for output files (default = working directory + "/output").}

\item{output_prefix}{Character. Filename prefix (default = "MRFI_comparison").}
=======
\item{output_dir}{Directory for output files (default = working directory + "/output").}

\item{output_prefix}{Filename prefix (default = "MRFI_comparison").}
>>>>>>> 9d6153617b215062451e987f0669f906bff0a505

\item{verbose}{Logical. Print progress messages (default = TRUE).}

\item{site_buffer}{Logical. Expand site boundary for analysis (default = FALSE).}

\item{buffer_width}{Numeric. Buffer distance in meters if site_buffer = TRUE.}

\item{mask_method}{Character. Masking method: "touches" or "none" (default = "touches").}

\item{use_coverage_weighting}{Logical. Use coverage-weighted rasterization (default = TRUE).}

<<<<<<< HEAD
\item{...}{Additional parameters passed to ignorance_map().}
}
\value{
A list with class "mrfi_comparison" containing: mrfi_initial (initial MRFI output), 
mrfi_updated (updated MRFI output), delta_irfi_raster (absolute change), efficiency_raster 
(percent change), discovery_value_raster (ignorance-weighted), performance_raster 
(efficiency-weighted), richness_gain_raster (taxa added), summary (statistics data frame), 
richness_comparison (richness statistics), targeting_efficiency (targeting metrics), 
and quadrant_analysis (quadrant breakdown).
=======
\item{...}{Additional parameters passed to \code{ignorance_map()}.}
}
\value{
A list with class "mrfi_comparison":
\itemize{
  \item{\code{mrfi_initial}}{Initial MRFI output (ignorance_map object)}
  \item{\code{mrfi_updated}}{Updated MRFI output (incremental calculation)}
  \item{\code{delta_irfi_raster}}{SpatRaster of IRFI changes (negative = reduction)}
  \item{\code{richness_gain_raster}}{SpatRaster of richness gains}
  \item{\code{summary}}{Data frame with comparison statistics}
  \item{\code{richness_comparison}}{Data frame with richness statistics}
  \item{\code{targeting_efficiency}}{Data frame with targeting metrics}
  \item{\code{quadrant_analysis}}{Data frame with quadrant breakdown}
}
>>>>>>> 9d6153617b215062451e987f0669f906bff0a505
}
\description{
Compares initial and updated floristic surveys using incremental MRFI calculation.
The updated MRFI is calculated as an UPDATE of the baseline (maintaining fixed
maximum ignorance) rather than independent recalculation, ensuring comparable
scales even when new taxa are discovered.

<<<<<<< HEAD
Visualization focuses on KNOWLEDGE GAINED with four complementary metrics:
dIRFI (absolute change), Efficiency (% change), Discovery Value (ignorance-weighted),
and Performance Score (efficiency-weighted, normalized by potential).
=======
Visualization focuses on KNOWLEDGE GAINED:
\itemize{
  \item{Page 1: Initial MRFI + IRFI Change (negative = knowledge gained)}
  \item{Page 2: Initial Richness + Richness Gain}
  \item{Page 3: Richness gain by IRFI category + Quadrant analysis}
  \item{Page 4: Summary statistics}
}
>>>>>>> 9d6153617b215062451e987f0669f906bff0a505

This function implements the evaluation phase (Q3) of the Next Generation
Floristics workflow (D'Antraccoli et al. 2022).
}
\details{
<<<<<<< HEAD
Metrics calculated: dIRFI = IRFI_updated - IRFI_initial (negative = improvement), 
Efficiency = (-dIRFI / IRFI_initial) × 100, Discovery Value = -dIRFI × (IRFI_initial / mean_IRFI), 
Performance Score = -dIRFI / mean_IRFI (normalized by potential).

PDF Output (5 pages, A4 landscape): Page 1 (Initial MRFI + Performance Score), 
Page 2 (Initial Richness + Richness Gain), Page 3 (Richness by IRFI + Performance scatterplot), 
Page 4 (Summary statistics), Page 5 (Metric comparison: all four metrics side-by-side).
=======
**Incremental MRFI Calculation:**

The updated MRFI is calculated as:
\code{IRFI_updated = max_ignorance_T1 - Σ(aged_baseline + new_observations)}

Where:
\itemize{
  \item{aged_baseline: T1 observations with temporal scores updated to T2}
  \item{new_observations: New observations between T1 and T2}
  \item{max_ignorance_T1: Fixed reference from initial survey (constant)}
}

**Sign Convention (dIRFI):**
\itemize{
  \item{dIRFI = IRFI_updated - IRFI_initial}
  \item{Negative values indicate knowledge gain (ignorance reduction)}
  \item{Positive values indicate knowledge loss (ignorance increase from temporal decay)}
}

**PDF Output (4 pages, A4 landscape):**
\itemize{
  \item{Page 1: Initial MRFI (left) + IRFI Change map (right, negative = gain)}
  \item{Page 2: Initial Richness (left) + Richness Gain map (right)}
  \item{Page 3: Richness by IRFI boxplot (left) + Quadrant analysis (right)}
  \item{Page 4: Summary statistics table}
}
>>>>>>> 9d6153617b215062451e987f0669f906bff0a505
}
